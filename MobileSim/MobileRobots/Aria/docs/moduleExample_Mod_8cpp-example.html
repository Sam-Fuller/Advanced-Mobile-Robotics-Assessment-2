<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Aria: moduleExample_Mod.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>moduleExample_Mod.cpp</h1>  </div>
</div>
<div class="contents">
<p>Example demonstrating how to implement a module with <a class="el" href="classArModule.html" title="Dynamicly loaded module base class, read warning in more.">ArModule</a> This is a simple example of how to define a module of code that Aria's <a class="el" href="classArModuleLoader.html" title="Dynamic ArModule loader.">ArModuleLoader</a> class can dynamically load at runtime. On Windows, loadable modules are DLL files. On Linux, they are shared object (.so) files (ARIA's Makefiles can compile any source file ending in "Mod.cpp" into a .so, so to build this module, run "make moduleExample_Mod.so"). <a class="el" href="classArModuleLoader.html" title="Dynamic ArModule loader.">ArModuleLoader</a> knows about these platform conventions, so only the base name (without the .dll or .so suffix) is used to load it. To implement a loadable module, you derive a class from <a class="el" href="classArModule.html" title="Dynamicly loaded module base class, read warning in more.">ArModule</a>, instantiate the pure virtual functions init() and exit(), and create an instance of that class. The two functions simply print out the equivalent of Hello World. An important part is the global instance of the class and the call to the macro ARDEF_MODULE(). Without that macro invocation, <a class="el" href="classAria.html" title="This class performs global initialization and deinitialization.">Aria</a> will never be able to invoke those two functions.</p>
<p>The program moduleExample.cpp is designed to load this module and check the error return.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>moduleExample.cpp. </dd>
<dd>
<a class="el" href="classArModule.html" title="Dynamicly loaded module base class, read warning in more.">ArModule</a> in the reference manual.</dd></dl>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;Aria.h&quot;</span>


<span class="keyword">class </span>SimpleMod : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="classArModule.html" title="Dynamicly loaded module base class, read warning in more.">ArModule</a>
{
<span class="keyword">public</span>:

  <span class="keywordtype">bool</span> <a name="a1"></a><a class="code" href="classArModule.html#a6774bb941d02907c8e4187011a9f3f8d" title="Initialize the module. The module should use the supplied ArRobot pointer.">init</a>(<a name="_a2"></a><a class="code" href="classArRobot.html" title="Central class for communicating with and operating the robot.">ArRobot</a> *robot, <span class="keywordtype">void</span> *argument = NULL);
  <span class="keywordtype">bool</span> <a name="a3"></a><a class="code" href="classArModule.html#a6556f5f806fbbd4f25b0c6f0c2997984" title="Close down the module and have it exit.">exit</a>();
};

SimpleMod aModule;
ARDEF_MODULE(aModule);

<span class="keywordtype">bool</span> <a class="code" href="classArModule.html#a6774bb941d02907c8e4187011a9f3f8d" title="Initialize the module. The module should use the supplied ArRobot pointer.">SimpleMod::init</a>(<a class="code" href="classArRobot.html" title="Central class for communicating with and operating the robot.">ArRobot</a> *robot, <span class="keywordtype">void</span> *argument)
{
  <a name="a4"></a><a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a name="a5"></a><a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;module: init(%p) called in the loaded module!&quot;</span>, robot);
  <span class="keywordflow">if</span> (argument != NULL)
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;module: Argument given to ArModuleLoader::load was the string &#39;%s&#39;.&quot;</span>, 
       (<span class="keywordtype">char</span> *)argument);
  <span class="keywordflow">else</span>
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;module: No argument was given to ArModuleLoader (this is OK).&quot;</span>);
    
  <span class="comment">// Do stuff here...</span>
    
  <span class="keywordflow">return</span>(<span class="keyword">true</span>);
}

<span class="keywordtype">bool</span> <a class="code" href="classArModule.html#a6556f5f806fbbd4f25b0c6f0c2997984" title="Close down the module and have it exit.">SimpleMod::exit</a>()
{
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;module: exit() called.&quot;</span>);

  <span class="comment">// Do stuff here...</span>

  <span class="keywordflow">return</span>(<span class="keyword">true</span>);
}
</pre></div> </div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Aug 23 2011 16:44:26 for Aria by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
