<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Aria: vcc4CameraExample.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>vcc4CameraExample.cpp</h1>  </div>
</div>
<div class="contents">
<p>This is an example using the Canon VC-C4 Pan/Tilt/Zoom camera.</p>
<p>This program uses key commands to control the pan, tilt, and zoom of the camera. It uses the same slew for the pan and tilt axes. It defaults to use the microcontroller port Aux1. See the setport comments below to use the computer's serial port, or a different aux port on the microcontroller.</p>
<p>Commands: _________________</p>
<p>UP,DOWN -- tilt up/down by 1 degree LEFT,RIGHT -- pan left/right by 1 degree X,C -- zoom in/out by 10 units (80 total) I -- initialize PTU to default settings &gt;,&lt; -- increase/decrease the positional increment by one 1 degree +,- -- increase/decrease the slew by 5 degrees/sec Z -- move pan and tilt axes to zero H -- Halt all motion S -- Status of camera position and variable values P -- Power on/off the camera ESC -- Exit program</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &quot;Aria.h&quot;</span>

<span class="comment">/*</span>
<span class="comment">  This class is the core of this demo, it adds itself to the robot given</span>
<span class="comment">  as a user task, then drives the PTZ camera from the keyboard</span>
<span class="comment">*/</span>
<span class="keyword">class </span>KeyPTU
{
<span class="keyword">public</span>:
  <span class="comment">// constructor</span>
  KeyPTU(<a name="_a0"></a><a class="code" href="classArRobot.html" title="Central class for communicating with and operating the robot.">ArRobot</a> *robot);
  <span class="comment">// destructor, its just empty</span>
  ~KeyPTU(<span class="keywordtype">void</span>) {}
  
  <span class="keywordtype">void</span> up(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> down(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> left(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> right(<span class="keywordtype">void</span>);

  <span class="keywordtype">void</span> plus(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> minus(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> greater(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> less(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> question(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> status(<span class="keywordtype">void</span>);

  <span class="keywordtype">void</span> c(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> h(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> i(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> p(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> x(<span class="keywordtype">void</span>);
  <span class="keywordtype">void</span> z(<span class="keywordtype">void</span>);

  <span class="keywordtype">void</span> r(<span class="keywordtype">void</span>);
  <span class="comment">// the callback function</span>
  <span class="keywordtype">void</span> drive(<span class="keywordtype">void</span>);

<span class="keyword">protected</span>:

  <a name="_a1"></a><a class="code" href="classArTime.html" title="A class for time readings and measuring durations.">ArTime</a> myExerciseTime;

  <span class="keywordtype">int</span> myPanSlew;
  <span class="keywordtype">int</span> myTiltSlew;
  <span class="keywordtype">int</span> myPosIncrement;
  <span class="keywordtype">int</span> mySlewIncrement;
  <span class="keywordtype">int</span> myZoomIncrement;

  <span class="keywordtype">bool</span> myMonitor;
  <span class="keywordtype">bool</span> myInit;
  <span class="keywordtype">bool</span> myAbsolute;
  <span class="keywordtype">bool</span> myExercise;

  <span class="keywordtype">void</span> exercise(<span class="keywordtype">void</span>) { myExercise = !myExercise; }
  <span class="keywordtype">void</span> autoupdate(<span class="keywordtype">void</span>);

  <a name="_a2"></a><a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myUpCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myDownCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myLeftCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myRightCB;

  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myPlusCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myMinusCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myGreaterCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myLessCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myQuestionCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> mySCB;

  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myECB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myACB;

  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myCCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myHCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myICB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myPCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myXCB;
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myZCB;

  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myRCB;

  <span class="comment">// the PTU</span>
  <a name="_a3"></a><a class="code" href="classArVCC4.html">ArVCC4</a> myPTU;

  <span class="comment">// the serial connection, in case we are connected to a computer</span>
  <span class="comment">// serial port</span>
  <a name="_a4"></a><a class="code" href="classArSerialConnection.html" title="For connecting to devices through a serial port.">ArSerialConnection</a> myCon;

  <span class="comment">// whether or not we&#39;ve requested that the Camera initialize itself</span>
  <span class="keywordtype">bool</span> myPTUInitRequested;
  <span class="comment">// pointer to the robot</span>
  <a class="code" href="classArRobot.html" title="Central class for communicating with and operating the robot.">ArRobot</a> *myRobot;
  <span class="comment">// callback for the drive function</span>
  <a class="code" href="classArFunctorC.html">ArFunctorC&lt;KeyPTU&gt;</a> myDriveCB;
};

<span class="comment">/*</span>
<span class="comment">  Constructor, sets the robot pointer, and some initial values, also note the</span>
<span class="comment">  use of constructor chaining on myPTU and myDriveCB.</span>
<span class="comment">*/</span>
KeyPTU::KeyPTU(<a class="code" href="classArRobot.html" title="Central class for communicating with and operating the robot.">ArRobot</a> *robot) :
  myUpCB(this, &amp;KeyPTU::up),
  myDownCB(this, &amp;KeyPTU::down),
  myLeftCB(this, &amp;KeyPTU::left),
  myRightCB(this, &amp;KeyPTU::right),
  myPlusCB(this, &amp;KeyPTU::plus),
  myMinusCB(this, &amp;KeyPTU::minus),
  myGreaterCB(this, &amp;KeyPTU::greater),
  myLessCB(this, &amp;KeyPTU::less),
  myQuestionCB(this, &amp;KeyPTU::question),
  mySCB(this, &amp;KeyPTU::status),
  myECB(this, &amp;KeyPTU::exercise),
  myACB(this, &amp;KeyPTU::autoupdate),
  myCCB(this, &amp;KeyPTU::c),
  myHCB(this, &amp;KeyPTU::h),
  myICB(this, &amp;KeyPTU::i),
  myPCB(this, &amp;KeyPTU::p),
  myXCB(this, &amp;KeyPTU::x),
  myZCB(this, &amp;KeyPTU::z),
  myRCB(this, &amp;KeyPTU::r),

  myPTU(robot),
  myDriveCB(this, &amp;KeyPTU::drive)
{
  <span class="comment">// set the robot pointer and add the KeyPTU as user task</span>
  <a name="_a5"></a><a class="code" href="classArKeyHandler.html" title="Perform actions when keyboard keys are pressed.">ArKeyHandler</a> *keyHandler;
  myRobot = robot;
  myRobot-&gt;<a name="a6"></a><a class="code" href="classArRobot.html#ab3ed1a09a96c009802ed64bbc6c75325" title="Adds a task under the sensor interp part of the syncronous tasks.">addSensorInterpTask</a>(<span class="stringliteral">&quot;KeyPTU&quot;</span>, 50, &amp;myDriveCB);

  myPTU.setLEDControlMode(2);
  myExerciseTime.setToNow();
  myExercise = <span class="keyword">false</span>;

<span class="comment">//  SETPORT Uncomment the following to run the camera off</span>
<span class="comment">//  of the computer&#39;s serial port, rather than the microcontroller</span>

<span class="comment">// uncomment below here</span>
<span class="comment">/*</span>
<span class="comment">#ifdef WIN32</span>
<span class="comment">  myCon.setPort(&quot;COM2&quot;);</span>
<span class="comment">#else</span>
<span class="comment">  myCon.setPort(&quot;/dev/ttyS0&quot;);</span>
<span class="comment">#endif</span>
<span class="comment">  myPTU.setDeviceConnection(&amp;myCon);</span>
<span class="comment">*/</span>
<span class="comment">// to here</span>

  <span class="comment">// or use this next line to set the aux port </span>
 <span class="comment">//myPTU.setAuxPort(2);</span>


  <span class="keywordflow">if</span> ((keyHandler = <a name="a7"></a><a class="code" href="classAria.html#a5b8042b38b19d6a5d3cfbed4df483e67" title="Gets a pointer to the global key handler, if one has been set with setKeyHandler().">Aria::getKeyHandler</a>()) == NULL)
  {
    keyHandler = <span class="keyword">new</span> <a class="code" href="classArKeyHandler.html" title="Perform actions when keyboard keys are pressed.">ArKeyHandler</a>;
    <a name="a8"></a><a class="code" href="classAria.html#a9e5496a4ec2c379c8e18706922b57cc1" title="Sets the key handler, so that other classes can find it using getKeyHandler().">Aria::setKeyHandler</a>(keyHandler);
    myRobot-&gt;attachKeyHandler(keyHandler);
  }

  <span class="keywordflow">if</span> (!keyHandler-&gt;<a name="a9"></a><a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<a name="a10"></a><a class="code" href="classArKeyHandler.html#a665246cd772590dd02ea299dd047899ca8a1d3905f01b5d27603bb0528912d341" title="Up arrow (keypad or 4 key dirs).">ArKeyHandler::UP</a>, &amp;myUpCB))
    <a name="a11"></a><a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a name="a12"></a><a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;The key handler already has a key for up, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<a name="a13"></a><a class="code" href="classArKeyHandler.html#a665246cd772590dd02ea299dd047899cab3ecf95789d8f87444856e278393b4d9" title="Down arrow (keypad or 4 key dirs).">ArKeyHandler::DOWN</a>, &amp;myDownCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;The key handler already has a key for down, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<a name="a14"></a><a class="code" href="classArKeyHandler.html#a665246cd772590dd02ea299dd047899ca4484301bbabab1fb37e72cbcd6e3e45b" title="Left arrow (keypad or 4 key dirs).">ArKeyHandler::LEFT</a>, &amp;myLeftCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,  
<span class="stringliteral">&quot;The key handler already has a key for left, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<a name="a15"></a><a class="code" href="classArKeyHandler.html#a665246cd772590dd02ea299dd047899ca220c952e7e336650ee7b3e0905971ede" title="Right arrow (keypad or 4 key dirs).">ArKeyHandler::RIGHT</a>, &amp;myRightCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,  
<span class="stringliteral">&quot;The key handler already has a key for right, keydrive will not work correctly.&quot;</span>);

  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;+&#39;</span>, &amp;myPlusCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;+&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;-&#39;</span>, &amp;myMinusCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;-&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;&gt;&#39;</span>, &amp;myGreaterCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;&gt;&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;&lt;&#39;</span>, &amp;myLessCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;&lt;&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;?&#39;</span>, &amp;myQuestionCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;?&#39;, keydrive will not work correctly.&quot;</span>);

  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;c&#39;</span>, &amp;myCCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;C&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;h&#39;</span>, &amp;myHCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;H&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;i&#39;</span>, &amp;myICB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;I&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;p&#39;</span>, &amp;myPCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;P&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;r&#39;</span>, &amp;myRCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;R&#39;, keydrive will not work correctly.&quot;</span>);

  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;s&#39;</span>, &amp;mySCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;S&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;x&#39;</span>, &amp;myXCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;X&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;z&#39;</span>, &amp;myZCB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>,
<span class="stringliteral">&quot;The key handler already has a key for &#39;Z&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;a&#39;</span>, &amp;myACB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;The key handler already has a key for &#39;A&#39;, keydrive will not work correctly.&quot;</span>);
  <span class="keywordflow">if</span> (!keyHandler-&gt;<a class="code" href="classArKeyHandler.html#ad5442ebb21cd242ab168e94686e06759" title="This adds a keyhandler, when the keyToHandle is hit, functor will fire.">addKeyHandler</a>(<span class="charliteral">&#39;e&#39;</span>, &amp;myECB))
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a012daf6573594f91242f8dd7c02eb74b" title="Use terse logging.">ArLog::Terse</a>, <span class="stringliteral">&quot;The key handler already has a key for &#39;E&#39;, keydrive will not work correctly.&quot;</span>);



  <span class="comment">// initialize some variables</span>

  myPTUInitRequested = <span class="keyword">false</span>;
  myPosIncrement = 1;
  mySlewIncrement = 5;
  myZoomIncrement = 50;

}

<span class="keywordtype">void</span> KeyPTU::autoupdate(<span class="keywordtype">void</span>)
{
  <span class="keywordflow">if</span> (myPTU.getAutoUpdate())
    myPTU.disableAutoUpdate();
  <span class="keywordflow">else</span>
    myPTU.enableAutoUpdate();
}

<span class="keywordtype">void</span> KeyPTU::right(<span class="keywordtype">void</span>)
{
  myPTU.panRel(myPosIncrement);
}

<span class="keywordtype">void</span> KeyPTU::left(<span class="keywordtype">void</span>)
{
  myPTU.panRel(-myPosIncrement);
}

<span class="keywordtype">void</span> KeyPTU::up(<span class="keywordtype">void</span>)
{
  myPTU.tiltRel(myPosIncrement);
}

<span class="keywordtype">void</span> KeyPTU::down(<span class="keywordtype">void</span>)
{
  myPTU.tiltRel(-myPosIncrement);
}

<span class="keywordtype">void</span> KeyPTU::x(<span class="keywordtype">void</span>)
{
  myPTU.zoom(myPTU.getZoom() + myZoomIncrement);
}

<span class="keywordtype">void</span> KeyPTU::c(<span class="keywordtype">void</span>)
{
  myPTU.zoom(myPTU.getZoom() - myZoomIncrement);
}

<span class="keywordtype">void</span> KeyPTU::i(<span class="keywordtype">void</span>)
{
  myPTU.init();
}

<span class="keywordtype">void</span> KeyPTU::plus(<span class="keywordtype">void</span>)
{
  myPTU.panSlew(myPTU.getPanSlew() + mySlewIncrement);
  myPTU.tiltSlew(myPTU.getTiltSlew() + mySlewIncrement);

  status();
}

<span class="keywordtype">void</span> KeyPTU::minus(<span class="keywordtype">void</span>)
{
  myPTU.panSlew(myPTU.getPanSlew() - mySlewIncrement);
  myPTU.tiltSlew(myPTU.getTiltSlew() - mySlewIncrement);

  status();
}

<span class="keywordtype">void</span> KeyPTU::greater(<span class="keywordtype">void</span>)
{
  myPosIncrement += 1;
  
  <span class="keywordflow">if</span> (myPosIncrement &gt; myPTU.getMaxPosPan())            <span class="comment">//Use pan range as reference for largest allowable positional increment</span>
    myPosIncrement = myPTU.getMaxPosPan();

  status();
}

<span class="keywordtype">void</span> KeyPTU::less(<span class="keywordtype">void</span>)
{
  myPosIncrement -= 1;

  <span class="keywordflow">if</span> (myPosIncrement &lt; 0)
    myPosIncrement = 0;

  status();
}


<span class="keywordtype">void</span> KeyPTU::z(<span class="keywordtype">void</span>)
{
  myPTU.panTilt(0,0);
  myPTU.zoom(0);
  status();
}


<span class="keywordtype">void</span> KeyPTU::r(<span class="keywordtype">void</span>)
{
  myPTU.reset();
}


<span class="keywordtype">void</span> KeyPTU::question(<span class="keywordtype">void</span>)
{
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a name="a16"></a><a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;\r\nCommands:\r\n_________________\r\n&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;UP,DOWN     -- tilt up/down by 1 increment&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;LEFT,RIGHT  -- pan left/right by 1 increment&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;X,C         -- zoom in/out by 50 units (2140 max)&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;I           -- initialize PTU to default settings&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;&gt;,&lt;         -- increase/decrease the positional increment by 1 degree&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;+,-         -- increase/decrease the slew by 5 degrees/sec&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Z           -- move pan and tilt axes to zero&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;E       -- toggle exercise mode&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;A       -- toggle autoupdate mode&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;H           -- Halt all motion&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;S           -- Status of camera position and variable values&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;P           -- Power on/off the camera&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;R           -- Reset the camera&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;ESC         -- Exit program&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;\r\n&quot;</span>);
}

<span class="keywordtype">void</span> KeyPTU::status(<span class="keywordtype">void</span>)
{
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;\r\nStatus:\r\n_________________________\r\n&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Pan Position       =  %.0f deg&quot;</span>, myPTU.getPan());
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Tilt Position      =  %.0f deg&quot;</span>, myPTU.getTilt());
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Zoom Position      =  %d&quot;</span>, myPTU.getZoom());
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Pan Slew           =  %d deg/s&quot;</span>, myPTU.getPanSlew());
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Tilt Slew          =  %d deg/s&quot;</span>, myPTU.getTiltSlew());
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Position Increment =  %d deg&quot;</span>, myPosIncrement);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Autoupdate         =  %d&quot;</span>, myPTU.getAutoUpdate());
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Exercise           =  %d&quot;</span>, myExercise);
  <span class="keywordflow">if</span> (myPTU.getPower())
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Power is ON&quot;</span>);
  <span class="keywordflow">else</span>
    <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;Power is OFF&quot;</span>);
  <a class="code" href="classArLog.html#a43a8b3789126c818f390f24bdbceccce" title="Log a message, with formatting and variable number of arguments.">ArLog::log</a>(<a class="code" href="classArLog.html#ac8cc0fb3aa323ab2a1c21340fdd1dce3a7040faf60eeb155eaa85d439b1066ca1" title="Use normal logging.">ArLog::Normal</a>, <span class="stringliteral">&quot;\r\n&quot;</span>);
}

<span class="keywordtype">void</span> KeyPTU::h(<span class="keywordtype">void</span>)
{
  myPTU.haltPanTilt();
  myPTU.haltZoom();
}

<span class="keywordtype">void</span> KeyPTU::p(<span class="keywordtype">void</span>)
{
  <span class="keywordflow">if</span> (myPTU.getPower())
    myPTU.power(0);
  <span class="keywordflow">else</span>
    myPTU.power(1);

  status();
}

<span class="comment">// the important function</span>
<span class="keywordtype">void</span> KeyPTU::drive(<span class="keywordtype">void</span>)
{
  <span class="comment">// if the PTU isn&#39;t initialized, initialize it here... it has to be </span>
  <span class="comment">// done here instead of above because it needs to be done when the </span>
  <span class="comment">// robot is connected</span>
  <span class="keywordflow">if</span> (!myPTUInitRequested &amp;&amp; !myPTU.isInitted() &amp;&amp; myRobot-&gt;isConnected())
  {
    printf(<span class="stringliteral">&quot;\nWaiting for Camera to Initialize\n&quot;</span>);
    myAbsolute = <span class="keyword">true</span>;
    myPTUInitRequested = <span class="keyword">true</span>;
    myPTU.init();
  }

  <span class="comment">// if the camera hasn&#39;t initialized yet, then just return</span>
  <span class="keywordflow">if</span> (myPTUInitRequested &amp;&amp; !myPTU.isInitted())
  {
    <span class="keywordflow">return</span>;
  }

  <span class="keywordflow">if</span> (myPTUInitRequested &amp;&amp; myPTU.isInitted())
  {
    myPTUInitRequested = <span class="keyword">false</span>;
    myPanSlew = myPTU.getPanSlew();
    myTiltSlew = myPTU.getTiltSlew();
    printf(<span class="stringliteral">&quot;Done.\n&quot;</span>);
    question();
  }

  <span class="keywordflow">if</span> (myExerciseTime.secSince() &gt; 5 &amp;&amp; myExercise)
  {
    <span class="keywordtype">int</span> pan,tilt;

    <span class="keywordflow">if</span> (<a name="a17"></a><a class="code" href="classArMath.html#aa6e0fe8a0dc83eab361e795105f44909">ArMath::random</a>()%2)
      pan = <a class="code" href="classArMath.html#aa6e0fe8a0dc83eab361e795105f44909">ArMath::random</a>()%((int)myPTU.getMaxPosPan());
    <span class="keywordflow">else</span>
      pan = -<a class="code" href="classArMath.html#aa6e0fe8a0dc83eab361e795105f44909">ArMath::random</a>()%((int)myPTU.getMaxNegPan());

    <span class="keywordflow">if</span> (<a class="code" href="classArMath.html#aa6e0fe8a0dc83eab361e795105f44909">ArMath::random</a>()%2)
      tilt = <a class="code" href="classArMath.html#aa6e0fe8a0dc83eab361e795105f44909">ArMath::random</a>()%((int)myPTU.getMaxPosTilt());
    <span class="keywordflow">else</span>
      tilt = -<a class="code" href="classArMath.html#aa6e0fe8a0dc83eab361e795105f44909">ArMath::random</a>()%((int)myPTU.getMaxNegTilt());

    myPTU.panTilt(pan, tilt);
    <span class="comment">//printf(&quot;** %d\n&quot;, myRobot-&gt;getEstop());</span>
    <span class="comment">//printf(&quot;--&gt; %x\n&quot;, myRobot-&gt;getFlags());</span>
    myExerciseTime.setToNow();
  }

}

<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) 
{
  <span class="comment">// just some stuff for returns</span>
  std::string str;
  <span class="comment">// robots connection</span>
  <a class="code" href="classArSerialConnection.html" title="For connecting to devices through a serial port.">ArSerialConnection</a> con;

  <span class="comment">// the robot, this turns state reflection off</span>
  <a class="code" href="classArRobot.html" title="Central class for communicating with and operating the robot.">ArRobot</a> robot(NULL, <span class="keyword">false</span>);
  <span class="comment">// the joydrive as defined above, this also adds itself as a user task</span>
  KeyPTU ptu(&amp;robot);

  <span class="comment">// mandatory init</span>
  <a name="a18"></a><a class="code" href="classAria.html#ad99c16b5d947229d9f8e1c5b2d4cdd73" title="Initialize Aria global data struture and perform OS-specific initialization, including adding OS sign...">Aria::init</a>();

  <span class="comment">//ArLog::init(ArLog::StdOut, ArLog::Normal, NULL, true);</span>

  con.<a name="a19"></a><a class="code" href="classArSerialConnection.html#a70d24c612f12fabc7c6fd9aff2de320d">setPort</a>(<a name="a20"></a><a class="code" href="classArUtil.html#a55c1a819493603958b733b516065ddca" title="First serial port device name (value depends on compilation platform).">ArUtil::COM1</a>);
  <span class="comment">// set the connection on the robot</span>
  robot.<a name="a21"></a><a class="code" href="classArRobot.html#afdefce1c9f642dae8e68201ec509b898" title="Sets the connection this instance uses.">setDeviceConnection</a>(&amp;con);

  <span class="comment">// connect, if we fail, exit</span>
  <span class="keywordflow">if</span> (!robot.<a name="a22"></a><a class="code" href="classArRobot.html#a1a9e2605e3ea568d697b74992c3eef1f" title="Connects to a robot, not returning until connection made or failed.">blockingConnect</a>())
  {
    printf(<span class="stringliteral">&quot;Could not connect to robot... exiting\n&quot;</span>);
    <a name="a23"></a><a class="code" href="classAria.html#a184602a2b3799d61569ec55dd9508450" title="Shutdown all Aria processes/threads.">Aria::shutdown</a>();
    <span class="keywordflow">return</span> 1;
  }


  <span class="comment">// turn off the sonar, enable the motors, turn off amigobot sounds</span>
  robot.<a name="a24"></a><a class="code" href="classArRobot.html#aceef80a6274fb34aafcc422e4b1778c1" title="Sends a command to the robot with an int for argument.">comInt</a>(<a name="a25"></a><a class="code" href="classArCommands.html#a9a31f904a95bbc31d8b33c6637100cc4a891b21e6cabc8a2296c8bceca20be779" title="int, enable (1) or disable (0) sonar">ArCommands::SONAR</a>, 0);
  robot.<a class="code" href="classArRobot.html#aceef80a6274fb34aafcc422e4b1778c1" title="Sends a command to the robot with an int for argument.">comInt</a>(<a name="a26"></a><a class="code" href="classArCommands.html#a9a31f904a95bbc31d8b33c6637100cc4aa8d799cced5def80525936119963aad4" title="int, enable (1) or disable (0) motors">ArCommands::ENABLE</a>, 1);
  robot.<a class="code" href="classArRobot.html#aceef80a6274fb34aafcc422e4b1778c1" title="Sends a command to the robot with an int for argument.">comInt</a>(<a name="a27"></a><a class="code" href="classArCommands.html#a9a31f904a95bbc31d8b33c6637100cc4a7a256695b7937192e88c976d2fd106e5" title="int, AmigoBot (old H8 model) specific, enable(1) or diable(0) sound">ArCommands::SOUNDTOG</a>, 0);

  printf(<span class="stringliteral">&quot;Press &#39;?&#39; for available commands\r\n&quot;</span>);
  <span class="comment">// run, if we lose connection to the robot, exit</span>
  robot.<a name="a28"></a><a class="code" href="classArRobot.html#afb40bb581fa61eb08a542840e4264e26" title="Starts the instance to do processing in this thread.">run</a>(<span class="keyword">true</span>);
  
  <span class="comment">// shutdown and go away</span>
  <a class="code" href="classAria.html#a184602a2b3799d61569ec55dd9508450" title="Shutdown all Aria processes/threads.">Aria::shutdown</a>();
  <span class="keywordflow">return</span> 0;
}

</pre></div> </div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Aug 23 2011 16:44:26 for Aria by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
